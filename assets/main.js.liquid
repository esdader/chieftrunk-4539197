var ChiefTrunk = ChiefTrunk || {};

ChiefTrunk = {

    common: {

        init: function () {
            var self = this;
            
            self.miniNavBtn        = $('.mini-nav-btn');
            self.miniNav           = $('.l-mini-nav-container');
            self.miniNavList       = $('.mini-nav');
            self.followBtn         = $('.footer-nav').find('.follow');
            self.miniFollowBtn     = $('.mini-nav').find('.follow');
            self.socialIcons       = $('.footer-nav').find('.social-media');
            self.miniSocialIcons   = $('.mini-nav').find('.social-media');
            self.socialClose       = $('.social-close');
            self.socialShowing     = false;
            self.miniSocialShowing = false;
            self.win               = $(window);
            
            self.email_button  = $('.email_button');
            self.mini_email_button  = $('.mini-email_button');
            self.emailSignup   = $('.emailsignup');

            self.goSignup        = $('.go-signup');
            self.miniGoSignup    = $('.mini-go-signup');
            self.xLoc            = 0;
            self.movedToMiniNave = false;
            
            self.emailForm     = $("#mc-embedded-subscribe-form");
            self.emailInput    = $("#mce-EMAIL");



          // deals with form submision
            var err_style = '';
            var options = { errorClass: 'mce_inline_error', errorElement: 'div', errorStyle: err_style, onkeyup: function(){}, onfocusout:function(){}, onblur:function(){}  };
              var mce_validator = self.emailForm.validate(options);

              options = { url:'http://chieftrunk.us7.list-manage1.com/subscribe/post-json?u=b5c7d2ba7d35a0faa71a59dfd&id=45f52cea4b&c=?', type: 'GET', dataType: 'json', contentType: "application/json; charset=utf-8",
                            beforeSubmit: function(){
                                $('#mce_tmp_error_msg').remove();
                                $('.datefield','#mc_embed_signup').each(
                                    function(){
                                        var txt = 'filled';
                                        var fields = [];
                                        var i = 0;
                                        $(':text', this).each(
                                            function(){
                                                fields[i] = this;
                                                i++;
                                            });
                                        $(':hidden', this).each(
                                            function(){
                                                if ( fields[0].value ==='MM' && fields[1].value ==='DD' && fields[2].value ==='YYYY' ){
                                                    this.value = '';
                                                } else if ( fields[0].value ==='' && fields[1].value ==='' && fields[2].value ==='' ){
                                                    this.value = '';
                                                } else {
                                                    this.value = fields[0].value+'/'+fields[1].value+'/'+fields[2].value;
                                                }
                                            });
                                    });
                                return mce_validator.form();
                            },
                            success: self.mce_success_cb
                        };
              self.emailForm.ajaxForm(options);

            self.vents();

        },

        mce_success_cb: function (resp){
            var self = this;

            if (resp.result=="success"){
               $('#mce-EMAIL').val('Thank You!');
            } else {
                $('#mce-EMAIL').val('Please Re-Enter');
            }
        },

        setXLoc: function() {
            var self = this;
            if (self.movedToMiniNave === false) {
                self.xLoc = self.goSignup.offset().left - 27;
                self.emailSignup.css('left', self.xLoc + 'px');
            }
        },

        placeMiniEmailBtn: function() {
            var self = this,
                xLoc = self.miniGoSignup.offset().left + 45,
                yLoc = self.miniGoSignup.offset().top;
                
                self.emailSignup.css({
                    'left': xLoc,
                    'top': yLoc
                });
        },

        vents: function () {
            var self = this;
            // make sure email signup opens where it should
            self.win.on('resize', function(){
                self.setXLoc();
            });

            // track clisks on email button
            self.email_button.on('click', function(e) {
                e.preventDefault();
                if(self.movedToMiniNave === true) {
                    self.emailSignup.appendTo($('body'));
                    self.movedToMiniNave = false;
                }
                self.setXLoc();
                self.emailSignup.toggle();
                self.socialIcons.hide(function(){
                    self.socialShowing = false;
                });
            });

            // track clicks on mini nav email button
            self.mini_email_button.on('click', function(e){
                e.preventDefault();
                if (self.movedToMiniNave === false) {
                    self.emailSignup.prependTo(self.miniGoSignup);
                    self.emailSignup.css('left', '45px');
                    self.movedToMiniNave = true;
                }
                self.emailSignup.toggle();
            });

            // clear placeholder text from email input
            self.emailInput.on('focus', function(e){
                $this = $(this);
                var val = $this.val();
                if (val === 'YOUR EMAIL') {
                    $this.val('');
                }
            });

            // track clicks on follow button
            self.followBtn.on('click', function(e) {
                e.preventDefault();
                self.emailSignup.hide();
                if (self.socialShowing === false) {
                    self.socialIcons.hide(function(){
                        self.socialIcons.fadeIn();
                        self.socialShowing = true;
                    });
                } else {
                    self.socialIcons.fadeOut();
                    self.socialShowing = false;
                }
                
            });

            // track clicks on mini follow button
            self.miniFollowBtn.on('click', function(e) {
                e.preventDefault();
                self.emailSignup.hide();
                if (self.miniSocialShowing === false) {
                    self.miniSocialIcons.hide(function(){
                        self.miniSocialIcons.fadeIn();
                        self.miniSocialShowing = true;
                    });
                } else {
                    self.miniSocialIcons.fadeOut();
                    self.miniSocialShowing = false;
                }
                
            });

            self.socialClose.on('click', function(e){
                e.preventDefault();
                self.miniSocialIcons.fadeOut();
                self.miniSocialShowing = false;
            });

            // track click on min nav button
            self.miniNavBtn.on('click', function(e) {
                e.preventDefault();
                // self.miniNavList.hammer().on('tap', function(e) {
                //     e.stopImediatePropagation();
                // });
                self.miniNav.addClass('is-open');
                self.trackOutsideClick();
            });
        },

        trackOutsideClick: function() {
            var self = this;

            $('html').on('click', function(e){
                self.miniNav.removeClass('is-open');
                $('html').off('click');
            });

            self.miniNav.on('click', function(e){
                e.stopPropagation();
            });

            self.emailSignup.on('click', function(e){
                e.stopPropagation();
            });
        }

    },

    giantImage: {
        init: function (config) {
            var self = this;

            // check if should track custom controls
            if ( typeof(config) !== 'undefined') {

                if ( typeof(config.customControls) !== 'undefined') {
                    
                    self.customControls = config.customControls;

                    self.nextBtns = $('.slider-next-btn');
                    self.prevBtns = $('.slider-prev-btn');
                    self.flex     = $('.flexslider');
                }

                if ( typeof(config.shortenTop) !== 'undefined') {
                    self.shortenTop = config.shortenTop;
                }

                
            }

            self.photoRatio  = 2000 / 1011;
            self.sideCrop    = 0;
            self.imageWidth  = 0;
            self.slideImage  = $('.slide-image');
            self.slideHolder = $('.slide-holder');

            if (!Modernizr.touch) {
                self.scaleLayout();
            } else {
                self.scaleSlides();
            }

            self.vents();
        },

        findLayout: function() {
            var self = this;

            self.winHeight = $(window).height();
            self.winWidth  = $(window).width();
            self.aspectRatio = self.winWidth / self.winHeight;
        },

        vents: function () {
            var self = this;

            $(window).resize(function(){
                
                if (!Modernizr.touch) {
                    self.scaleLayout();
                } else {
                    self.scaleSlides();
                }
            });

            if (self.customControls === true ) {
                self.nextBtns.on('click', function(e) {
                    e.preventDefault();
                    self.flex.flexslider('next');
                });

                self.prevBtns.on('click', function(e) {
                    e.preventDefault();
                    self.flex.flexslider('previous');
                });
            }
        },

        scaleLayout: function () {
            var self = this,
                topOffset = 0,
                activeSlide = $('.flex-active-slide');

            self.findLayout();
            
            if (self.aspectRatio > self.photoRatio) {
               
                if ( self.shortenTop === true) {
                    topOffset = 1011 / 2000 * self.winWidth - self.winHeight;

                    if (topOffset < 0) {
                        topOffset = 0;
                    }
                }

                self.slideImage.css({
                    'margin-left' : '0',
                    'margin-top' : '-' + topOffset + 'px',
                    'width' : self.winWidth+'px',
                    'height' : 'auto'
                });

                
                



            } else {
                self.sideCrop = (self.winHeight *  self.photoRatio - self.winWidth) / 2;
                self.imageWidth = self.winHeight * self.photoRatio;
                var marginLeft = '-' + self.sideCrop + 'px';
                self.slideImage.css({
                    'margin-left' : '-'+self.sideCrop+'px',
                    'width' : self.imageWidth+'px',
                    'height' : self.winHeight+'px'
                });

            }
        },

        scaleSlides: function () {
            var self = this,
                topOffset = 0;
            self.findLayout();

            if (self.aspectRatio > self.photoRatio) {

                if ( self.shortenTop === true) {
                    topOffset = 1011 / 2000 * self.winWidth - self.winHeight;

                    if (topOffset < 0) {
                        topOffset = 0;
                    }
                }
               
               self.slideImage.css({
                    'margin-left' : '0',
                    'width' : self.winWidth+'px',
                    'height' : 'auto',
                    'margin-top' : '-' + topOffset + 'px'
                });
            } else {
                self.sideCrop = (self.winHeight * self.photoRatio - self.winWidth) / 2;
                self.imageWidth = self.winHeight * self.photoRatio;
                self.slideImage.css({
                    'margin-left' : '-'+self.sideCrop+'px',
                    'width' : self.imageWidth+'px',
                    'height' : self.winHeight+'px'
                });
            }

        }
    },

    product: {

        init: function () {
            var self = this;

            self.$window             = $(window);
            self.mainHeader          = $('.main-header');
            self.mainFooter          = $('.main-footer');
            self.productInfo         = $('.product-info');
            self.productInfoWidth    = self.productInfo.outerWidth(true);
            self.productInfoHeight   = self.productInfo.height();
            self.productImages       = $('.product-images');
            self.imageLinks          = self.productImages.find('.thmb-links');
            self.thumbs              = self.productImages.find('img');
            self.productImagesWidth  = self.productImages.outerWidth(true);
            self.productImagesHeight = self.productImages.height();
            self.winHeight           = $.waypoints('viewportHeight');
            self.winWidth            = $(window).width();
            self.mainImage           = $('.featured-img');
            self.tip                 = $('.tool-tip');
            self.close_btn           = $('.close-btn');
            self.giantImageHolder    = $('.giant-image-holder');
            self.giantImage          = self.giantImageHolder.find('img');
            self.invisibles          = $('.invisible');
            self.bod                 = $('body');
            self.tallestCol          = 0;
            self.availableWidth      = 0;
            self.availableHeight     = 0;
            self.colMargin           = 0;

            self.productForm         = $('#product-form');
            self.add_btn             = $('#add');


            self.productFormOptions = {
                url:'/cart/add.js',
                type: 'POST',
                dataType: 'json',
                contentType: "application/json; charset=utf-8",
                beforeSubmit: function(){
                    self.add_btn.hide();
                },
                success: self.itemAdded
            };
              

            // kick off functions
            if (self.winWidth > 849) {
                self.initializeProductPage();
            } else {
                self.bod.addClass('small-product-view');
                self.displayItems();
            }
            
            self.vents();

        },

        vents: function () {
            var self = this;

            $(window).on('resize', function(e) {
                self.redoPageLayout(e, self);
            });

            self.imageLinks.on('click', function(e){
                e.preventDefault();
                var $this    = $(this),
                    earl     = $this.attr('href'),
                    theAlt   = $this.attr('alt'),
                    theGiant = $this.data('giant-image');
                
                self.mainImage
                    .fadeOut(function(){
                        self.mainImage.attr({'src': earl, 'alt': theAlt})
                            .data('giant-image', theGiant)
                            .fadeIn();
                    });
                    
            });

            if ($(window).width() > 940 ) {
                //Tooltips
                self.mainImage.hover(function(){
                    self.tip.show(); //Show tooltip
                }, function() {
                    self.tip.hide(); //Hide tooltip
                })
                .mousemove(function(e) {
                    //Change these numbers to move the tooltip offset
                    var mousex = e.pageX + 16; //Get X coodrinates
                    var mousey = e.pageY + 16 - 107; //Get Y coordinates. 
                    var tipWidth = self.tip.width(); //Find width of tooltip
                    var tipHeight = self.tip.height(); //Find height of tooltip
                    
                    //Distance of element from the right edge of viewport
                    var tipVisX = $(window).width() - (mousex + tipWidth);
                    //Distance of element from the bottom of viewport
                    var tipVisY = $(window).height() - (mousey + tipHeight);
                    if (tipVisX < 20) { //If tooltip exceeds the X coordinate of viewport
                        mousex = e.pageX - tipWidth - 20;
                    } if (tipVisY < 20) { //If tooltip exceeds the Y coordinate of viewport
                        mousey = e.pageY - tipHeight - 20 - 107;
                    }
                    //Absolute position the tooltip according to mouse position
                    self.tip.css({  top: mousey, left: mousex });
                })
                .on('click', function(e){
                    e.preventDefault();

                    var $this = $(this),
                        earl  = self.mainImage.data('giant-image');

                    self.giantImage.attr('src', earl);
                    self.giantImageHolder.fadeIn();
                });

                self.giantImageHolder.hover(function(){
                    self.close_btn.show(); //Show tooltip
                }, function() {
                    self.close_btn.hide(); //Hide tooltip
                })
                .mousemove(function(e) {
                    //Change these numbers to move the tooltip offset
                    var mousex = e.pageX + 16; //Get X coodrinates
                    var mousey = e.pageY + 16; //Get Y coordinates. 
                    var tipWidth = self.close_btn.width(); //Find width of tooltip
                    var tipHeight = self.close_btn.height(); //Find height of tooltip
                    
                    //Distance of element from the right edge of viewport
                    var tipVisX = $(window).width() - (mousex + tipWidth);
                    //Distance of element from the bottom of viewport
                    var tipVisY = $(window).height() - (mousey + tipHeight);
                    if (tipVisX < 20) { //If tooltip exceeds the X coordinate of viewport
                        mousex = e.pageX - tipWidth - 20;
                    } if (tipVisY < 20) { //If tooltip exceeds the Y coordinate of viewport
                        mousey = e.pageY - tipHeight - 20;
                    }
                    //Absolute position the tooltip according to mouse position
                    self.close_btn.css({  top: mousey, left: mousex });
                })
                .on('click', function(e){
                    e.preventDefault();

                    var $this = $(this);
                    $this.fadeOut();
                });
            }

            self.productForm.ajaxForm(self.productFormOptions);

        },

        itemAdded: function() {
            $('.adding-msg').delay(800).fadeOut(function(){
                $('.added-msg').fadeIn(function(){
                    $('#add').delay(2000).fadeIn();
                });
            });

            var cc       = $('.cart-count'),
                miniCC = $('.mini-cart-count'),
                count    = parseInt(cc.text(), 10),
                newCount;

            if (isNaN(count)) {
                newCount = "1";
            } else {
                newCount = count + 1;
            }

            cc.text(" " + newCount);
            miniCC.text(" " + newCount);
        },

        displayItems: function() {
            var self = this;

            self.invisibles
                .hide(function() {
                    $(this)
                        .removeClass('invisible')
                        .fadeIn();
                });
        },

        initializeProductPage: function () {


            var self = this;

            self.winHeight = $.waypoints('viewportHeight');
            self.winWidth  = $(window).width();

            self.availableHeight = self.winHeight - self.mainHeader.height() - self.mainFooter.height() - 40;
            
            self.availableWidth  = self.winWidth - self.productInfoWidth - self.productImagesWidth - 5;


            // set image height or width
            if (self.availableHeight > self.availableWidth) {
                var imageTopMargin = (self.availableHeight - self.availableWidth) / 2;
                self.mainImage.css({
                    'max-width': self.availableWidth,
                    'height': 'auto',
                    'margin-top': imageTopMargin,
                    'max-height': 'none'
                });
            } else {
                var mLeft = ((self.winWidth - self.availableHeight) / 2 - self.productInfoWidth) / 2;
                if (mLeft < 40) {
                    mLeft = 40;
                    self.availableHeight -= 80;
                }
                if (typeof mLeft === "undefined") {
                    mLeft = 40;
                    self.availableHeight -= 80;
                }
                self.mainImage.css({
                        'max-height': self.availableHeight,
                        'width': 'auto',
                        'max-width': 'none'
                        });
                self.productInfo.css('margin-left', mLeft + 'px');
                self.productImages.css('margin-right', mLeft + 'px');

            }

            // center columns within page

            if (self.productInfoHeight > self.productImagesHeight) {
                self.productImages.css('height', self.productInfoHeight);
                var topMargin = (self.availableHeight - self.productInfoHeight) / 2;
                if (topMargin < 0 ) {
                    topMargin = 0;
                }
                self.productImages.css('margin-top', topMargin);
                self.productInfo.css('margin-top', topMargin);
                var $thumbs = $(self.thumbs);
                var twoCol = $('.two-col');
                var thmbMargin = 0;
                if (twoCol.length === 0) {
                    thmbMargin = (self.productInfoHeight - $thumbs.length * 80) / 2;
                    $(self.thumbs[0]).css('margin-top', thmbMargin);
                } else {
                    thmbMargin = (self.productInfoHeight - Math.floor($thumbs.length / 2) * 80) / 2;
                    self.productImages.css('padding-top', thmbMargin);
                }
                
                

            }

            self.displayItems();

        },

        redoPageLayout: function(e, self) {

            self.winHeight = $(window).height();
            self.winWidth  = $(window).width();

            if (self.winWidth > 849) {
                if (self.bod.hasClass('small-product-view')) {
                    self.bod.removeClass('small-product-view');
                    self.productImagesWidth = self.productImages.outerWidth(true);
                    self.productInfoWidth = self.productInfo.outerWidth(true);
                    // self.mainImage.removeAttr('style');
                    // self.productInfo.removeAttr('style');
                    // self.productImages.removeAttr('style');
                }
            } else {
                if (self.bod.hasClass('small-product-view') === false) {
                    self.bod.addClass('small-product-view');
                    self.mainImage.removeAttr('style');
                    self.productInfo.removeAttr('style');
                    self.productImages.removeAttr('style');
                    self.productImages.find('img').removeAttr('style');
                }
            }

            if (self.winWidth > 849) {
                self.availableHeight = self.winHeight - self.mainHeader.height() - self.mainFooter.height() - 40;
                
                self.availableWidth  = self.winWidth - self.productInfoWidth - self.productImagesWidth - 5;

                // set image height or width
                if (self.availableHeight > self.availableWidth) {
                    var imageTopMargin = (self.availableHeight - self.availableWidth) / 2;
                    self.mainImage.css({
                        'max-width': self.availableWidth,
                        'height': 'auto',
                        'margin-top': imageTopMargin,
                        'max-height': 'none',
                        'position': 'absolute',
                        'left': '50%',
                        'margin-left': -self.availableWidth / 2 + 'px'
                    });
                } else {
                    var mLeft = ((self.winWidth - self.availableHeight) / 2 - self.productInfoWidth) / 2;
                    if (mLeft < 40) {
                        mLeft = 40;
                        self.availableHeight -= 80;
                    }
                    if (typeof mLeft === "undefined") {
                        mLeft = 40;
                        self.availableHeight -= 80;
                    }
                    self.mainImage.css({
                            'max-height': self.availableHeight,
                            'width': 'auto',
                            'max-width': 'none',
                            'position': 'absolute',
                            'left': '50%',
                            'margin-left': -self.availableHeight / 2 + 'px'
                            });
                    self.productInfo.css('margin-left', mLeft + 'px');
                    self.productImages.css('margin-right', mLeft + 'px');

                }

                // center columns within page

                if (self.productInfoHeight > self.productImagesHeight) {
                    self.productImages.css('height', self.productInfoHeight);
                    var topMargin = (self.availableHeight - self.productInfoHeight) / 2;
                    if (topMargin < 0 ) {
                        topMargin = 0;
                    }
                    self.productImages.css('margin-top', topMargin);
                    self.productInfo.css('margin-top', topMargin);
                    var $thumbs = $(self.thumbs);
                    var twoCol = $('.two-col');
                    var thmbMargin = 0;
                    if (twoCol.length === 0) {
                        thmbMargin = (self.productInfoHeight - $thumbs.length * 80) / 2;
                        $(self.thumbs[0]).css('margin-top', thmbMargin);
                    } else {
                        thmbMargin = (self.productInfoHeight - Math.floor($thumbs.length / 2) * 80) / 2;
                        self.productImages.css('padding-top', thmbMargin);
                    }

                }
            }

        }
    },

    shopLanding: {

    },

    products: {
        init: function() {
            var self = this;

            self.headerHeight      = $('.main-header').height();
            self.productsLanding   = $('.products-landing');
            self.lastSectionHeight = self.productsLanding.find('section').last().height();

            // set bottom padding
            //self.setBottomPadding();
        },
        setBottomPadding: function() {
            var self      = this,
                winHeight = $(window).height(),
                bottomPadding;

            bottomPadding = winHeight - self.headerHeight - self.lastSectionHeight;
            self.productsLanding.css('padding-bottom', bottomPadding);
        }
    },

    adminPages: {
        init: function () {
            var self = this;
            
            self.win                 = $(window);
            self.header              = $('.main-header');
            self.headerHeight        = self.header.outerHeight();
            self.footer              = $('main-footer');
            self.footerHeight        = self.footer.outerHeight();
            self.availableHeight     = 0;
            self.modal               = $('.callout-article');
            self.modalHeight         = self.modal.height();
            self.initialModalHeight  = self.modalHeight;
            self.articleHeaderHeight = self.modal.find('.callout-header').outerHeight();
            self.articleFooterHeight = self.modal.find('.callout-footer').outerHeight();
            self.articleBody         = self.modal.find('.callout-body');
            self.articleBodyHeight   = 0;

            self.isShowing   = false;
            self.isScrolling = false;

            self.vents();
            self.checkInitialHeights();

        },

        checkInitialHeights: function() {
            var self = this;
            if (self.win.width() > 565 ) {
                self.availableHeight = self.win.height() - self.headerHeight - self.footerHeight - 40;
                if (self.availableHeight > self.initialModalHeight) {
                    self.positionModal();
                } else {
                    self.setBodyHeight();
                }
            } else {
                self.modal.addClass('not-scrollable');
                $('body').removeClass('alt-color');
                self.header.css('background-color', '#fff');

                if (self.isShowing === false) {
                    self.modal.fadeIn();
                    self.isShowing = true;
                }
            }
        },

        positionModal: function() {
            var self = this,
                mTop = (self.availableHeight - self.modalHeight) / 2;

            if (self.modal.hasClass('not-scrollable') === false) {
                self.modal.addClass('not-scrollable');
            }
            self.modal.css('margin-top', mTop + "px");

            if (self.isShowing === false) {
                self.modal.fadeIn();
                self.isShowing = true;
            }


        },

        setBodyHeight: function() {
            var self = this;

            self.articleBodyHeight = self.availableHeight - self.articleHeaderHeight - self.articleFooterHeight;
            
            if (self.articleBodyHeight < 120) {
                self.articleBodyHeight = 120;
            }

            self.articleBody.css('height', self.articleBodyHeight + 'px');

            if (self.isShowing === false) {
                self.modal.fadeIn();
                self.isShowing = true;
            }

            if (self.isScrolling === false) {
                self.articleBody.mCustomScrollbar({
                    theme:"dark",
                    autoDraggerLength: false
                });

                self.isScrolling = true;
            }
        },

        vents: function() {
            var self = this;
            self.win.on('resize', function(){
                self.availableHeight = self.win.height() - self.header.outerHeight() - $('.main-footer').outerHeight() - 40;
                if (self.win.width() > 565) {
                    if (self.availableHeight > self.initialModalHeight) {
                        if (self.isScrolling === true) {
                            self.articleBody.mCustomScrollbar('destroy');
                            self.isScrolling = false;
                        }
                        self.positionModal();
                    } else {
                        if (self.isScrolling === false) {
                            self.articleBody.mCustomScrollbar({
                                theme:"dark",
                                autoDraggerLength: false
                            });
                            self.isScrolling = true;
                        }
                        self.modal.removeClass('not-scrollable');
                        self.setBodyHeight();
                    }
                }
            });
        }
    },

    care: {
        init: function() {
            var self = this;
            
            self.careGuide       = $('.care-guide');
            self.careGuideHeight = self.careGuide.height();
            self.headerHeight    = $('.main-header').outerHeight();
            self.footerHeight    = $('.main-footer').height();
            self.win             = $(window);
            self.careCon         = $('.care-container');
            self.visible         = false;
            self.body            = $('body');

            self.guideBtns       = self.careGuide.find('section').not('.intro .care-infographic');

            self.setCareHeight();
            self.positionGuide();
            self.vents();

            if (self.win.width() <= 944) {
                $('body').addClass('show-care');
            }
            
        },

        setCareHeight: function(){
            var self        = this,
                aspectRatio = self.win.height() / self.win.width(),
                landScape   = false,
                careConHeight, footyH;
             
            if(aspectRatio < 1) {
                if (Modernizr.touch) {
                    if ( self.win.width() < 570) {
                        landScape = true;
                    }
                }
            }

            if (landScape === false) {
                if (self.win.width() > 565) {
                    footyH = self.footerHeight;
                } else {
                    footyH = 0;
                }

                careConHeight = self.win.height() - self.headerHeight - footyH;

                self.careCon.height(careConHeight);
            }
        },

        positionGuide: function() {
            var self = this,
                availableMargin = self.win.height() - self.headerHeight - self.footerHeight - self.careGuideHeight;

            if (availableMargin > 0) {
                var mTop = availableMargin / 2;

                self.careGuide.css('margin-top', mTop + 'px');

                if (self.visible === false) {
                    self.careGuide.fadeIn();
                    self.visible = true;
                }

            } else {
                
                if (self.visible === false) {
                    self.careGuide.fadeIn();
                    self.visible = true;
                }
            }
        },

        vents: function() {
            var self = this;

            self.win.on('resize', function(){
                if (self.win.width() > 944) {
                    if( self.body.hasClass('show-care')) {
                        self.body.removeClass('show-care');
                        self.visible = false;
                        self.guideBtns.removeClass('showing-guide').find('.guide-info').hide();
                    }
                } else {
                    if (self.body.hasClass('show-care') === false) {
                        self.body.addClass('show-care');
                        self.guideBtns.find('.guide-info').show();
                    }
                }
                self.positionGuide();
                self.setCareHeight();
            });

            self.guideBtns.on('click mouseenter', function(e){

                if (self.win.width() > 944) {
                    var $this = $(this);

                    $('.showing-guide')
                        .not($this)
                        .removeClass('showing-guide')
                        .find('.guide-info')
                            .fadeOut();
                    
                    $this
                        .addClass('showing-guide')
                        .find('.guide-info')
                            .fadeIn();
                }
            });

        }
    },

    journal: {
        init: function(){
            var self        = this;
            self.win        = $(window);
            self.journalEntry = $('.journal-entry-container');
            self.mainHeader = $('.main-header');
            self.mainFooter = $('.main-footer');
            
            self.setJournalHeight();
            self.vents();
        },
        setJournalHeight: function() {
            var self = this;
            var h = self.win.height() - self.mainHeader.outerHeight() - self.mainFooter.outerHeight();
            self.journalEntry.height(h);
        },
        vents: function() {
            var self = this;
            self.win.on('resize', function(e){
                self.setJournalHeight();
            });
        }
    },
    lineage: {
        init: function(){
            var self              = this;
            self.win              = $(window);
            self.lineageContainer = $('.lineage-container');
            self.mainHeader       = $('.main-header');
            self.mainFooter       = $('.main-footer');
            
            self.setLineageHeight();
            self.vents();

        },
        setLineageHeight: function() {
            var self = this;
            
                if (self.win.width() > 565) {
                    footyH = self.mainFooter.outerHeight();
                } else {
                    footyH = 0;
                }
                var h = self.win.height() - self.mainHeader.outerHeight() - footyH;
                self.lineageContainer.height(h);
            
        },
        vents: function() {
            var self = this;
            self.win.on('resize', function(e){
                self.setLineageHeight();
            });
        }
    }

};
