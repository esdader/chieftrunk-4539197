<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="canonical" href="{{ canonical_url }}" /> 
{% if template == "index" %}
    <title>{{ shop.name  }}</title>
{% elsif template contains "404" %}
    <title>Page Not Found</title>
{% else %}
    <title>{{ page_title | escape }} | {{ shop.name }}</title>
{% endif %}  
    
{% assign maxmeta = 155 %} 
{% if template contains 'product' %}
    <meta name="description" content="{{ product.description | strip_html | strip_newlines | truncate: maxmeta | escape }}" />
{% elsif template contains 'page' %}
    <meta name="description" content="{{ page.content | strip_html | strip_newlines | truncate: maxmeta | escape }}" />
{% elsif template == 'index' and shop.description != '' %}
    <meta name="description" content="{{ shop.description | strip_html | strip_newlines | truncate: maxmeta | escape}}" />
{% endif %}
    <meta name="viewport" content="width=device-width, initial-scale=1">

    {{ 'normalize.css' | asset_url | stylesheet_tag }}
    {{ 'main.css' | asset_url | stylesheet_tag }}
    {{ 'modernizr-2.6.2.min.js' | asset_url | script_tag }}
    {{ content_for_header }}
</head>
<body class="{{page.handle}}{% if template == 'index' %} alt-color{% endif %}{% if template contains 'shop' %} alt-color{% endif %}">
{% if template contains 'shop' %}
    {% assign image_class = 'shop' %}
    <div class="full-body-img {{ image_class }}-bg-img"> </div>
{% endif %}

{% if template == 'index' %}
    <div class="homepage-full-bg">
        <div class="flexslider">
          <ul class="slides">
            <li class="slide-holder">
              <img src="{{'Home_Slide_1.jpg' | asset_url }}" alt="" class="slide-image">
            </li>
            <li class="slide-holder">
              <img src="{{'Home_Slide_2.jpg' | asset_url }}" alt="" class="slide-image">
            </li>
            <li class="slide-holder">
              <img src="{{'Home_Slide_3.jpg' | asset_url }}" alt="" class="slide-image">
            </li>
          </ul>
        </div>
    </div>
{% endif %}
<header class="main-header">
    <nav class="main-nav clearfix">
        <a href="{{ shop.url }}" class="main-logo logo-dark"><img src="{{ 'chief_trunk_logo_dark.png' | asset_url }}" alt="Chief Trunk logo"></a>
        <a href="{{ shop.url }}" class="main-logo logo-light"><img src="{{ 'chief_trunk_logo.png' | asset_url }}" alt="Chief Trunk logo"></a>
        <ul class="l-horizontal-nav large-nav not-small-screen">
            {% for link in linklists.main-menu.links %}
                <li class="{{ link.title | handleize }}{% if link.active %} active{% endif %}">
                    <a href="{{ link.url }}" title="{{ link.title }}">
                        {{ link.title }}
                    </a>
                </li>
            {% endfor %}
        </ul>
        
        <div class="l-mini-nav-container">
            <a href="#open-menu" class="mini-nav-btn small-screen">Menu</a>
            <div class="mini-nav">
                <ul class="small-screen mini-nav-links">
                    {% for link in linklists.small-screen-nav.links %}
                        <li class="{{ link.title | handleize }}{% if link.active %} active{% endif %}">
                            <a href="{{ link.url }}" title="{{ link.title }}">
                                {{ link.title }}
                            </a>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </nav>
</header>

{{ content_for_layout }}

<footer class="main-footer  not-small-screen">
    <nav class="footer-nav">
        <ul class="l-horizontal-nav">
            {% for link in linklists.footer.links %}
                <li><a href="{{ link.url }}" title="{{ link.title }}" class="{{ link.title | handleize }}{% if link.active %} active{% endif %}">{{ link.title }}</a></li>
            {% endfor %}
        </ul>
    </nav>
</footer>



    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="{{ "jquery-1.10.2.min.js" | asset_url }}"><\/script>')</script>
    {{ 'plugins.js' | asset_url | script_tag }}
    {{ 'main.js' | asset_url | script_tag }}
    {% if template == 'index' %}
        <script>
            $(window).load(function() {
                function scale_layout(){
                    var winheight = $(window).height();
                    var winwidth = $(window).width();
                    var aspect_ratio = winwidth / winheight;
                    var photo_ratio = 2000 / 1011;

                    if (aspect_ratio > photo_ratio) {
                       $('.slide-image').css({
                            'margin-left' : '0',
                            'width' : winwidth+'px',
                            'height' : 'auto'
                        });
                        
                        var header_width = winwidth * 0.26;

                    } else {
                        var side_crop = (winheight *  photo_ratio - winwidth) / 2;
                        var image_width = winheight * photo_ratio;

                        $('.slide-image').css({
                            'margin-left' : '-'+side_crop+'px',
                            'width' : image_width+'px',
                            'height' : winheight+'px'
                        });
         
                    }
                }



              if (!Modernizr.touch) {
                    scale_layout();
                    $(window).resize(function(){scale_layout();});
                } else {
                    function scale_slides(){
                        var winheight = $(window).height();
                        var winwidth = $(window).width();
                        var aspect_ratio = winwidth / winheight;
                        if (aspect_ratio > photo_ratio) {
                           $('.slide-image').css({
                                'margin-left' : '0',
                                'width' : winwidth+'px',
                                'height' : 'auto'
                            });
                        } else {
                            var side_crop = (winheight * photo_ratio - winwidth) / 2;
                            var image_width = winheight * photo_ratio;
                            $('.slide-image').css({
                                'margin-left' : '-'+side_crop+'px',
                                'width' : image_width+'px',
                                'height' : winheight+'px'
                            });
                        }
                        fix_margin_top();
                    }
                    scale_slides();
                    $(window).resize(function(){scale_slides();});

                }


             $('.flexslider').flexslider({
                animation: "fade",
                controlNav: false,
                directionNav: false,
                slideshowSpeed: 5000
              });
            });
        </script>
    {% endif %}
    {% if template contains 'product' %}
        <script>
            $(window).load(function(){

                var CheifTrunkProduct = (function ($, window) {

                        var productInfo         = $('.product-info'),
                            productInfoWidth    = productInfo.width(),
                            productInfoHeight    = productInfo.height(),
                            productImages       = $('.product-images'),
                            thumbs              = productImages.find('img'),
                            productImagesWidth  = productImages.width(),
                            productImagesHeight = productImages.height(),
                            winHeight      = $.waypoints('viewportHeight'),
                            winWidth            = $(window).width(),
                            mainImage           = $('.featured-img'),
                            tallestCol, availableWidth, availableHeight, colMargin;

                        function initializeProductPage () {
                            availableHeight = winHeight - 170;
                            availableWidth = winWidth - productInfoWidth - productImagesWidth;

                            // set image height or width
                            if (availableHeight > availableWidth) {
                                mainImage.css({'max-width': availableWidth, 'height': 'auto'});
                            } else {
                                var mLeft = availableHeight / 2;
                                mainImage.css({
                                        'max-height': availableHeight,
                                        'width': 'auto',
                                        'position': 'absolute',
                                        'left': '50%',
                                        'margin-left': -availableHeight / 2
                                        
                                        });
                                colMargin = (availableWidth - availableHeight) / 4;
                                productInfo.css('margin-left', colMargin);
                                productImages.css('margin-right', colMargin);

                            }

                            // center columns within page

                            if (productInfoHeight > productImagesHeight) {
                                productImages.css('height', productInfoHeight);
                                var topMargin = (availableHeight - productInfoHeight) / 2;
                                productImages.css('margin-top', topMargin);
                                productInfo.css('margin-top', topMargin);
                                var $thumbs = $(thumbs);
                                var thmbMargin = (productInfoHeight - $thumbs.length * 70) / 2;
                                
                                $(thumbs[0]).css('margin-top', thmbMargin);


                            }

                        }
                        initializeProductPage();

                })(jQuery, window);
            });
        </script>
    {% endif %}
</body>
</html>
